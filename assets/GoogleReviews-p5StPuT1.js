import{r as E,c5 as A,d as S,c8 as x,c7 as o,c9 as r,C as s,aj as e,bb as w,ax as t,z as u,cb as y,cg as J,aF as Q,w as W,a1 as X,c6 as h,a5 as z,ca as D}from"./vuetify-CdQs1uHv.js";import{p as Z,V as $,g as L,c as B,q as N,o as O,d as j,a as M,_ as Y,u as ee,r as te,n as se,s as G,t as ae}from"./index-Bze8vtIM.js";import{u as re}from"./swiper-scroll-Bo_abshO.js";import{E as oe,a as le}from"./EmptyState-C2QJTgDZ.js";function ne(b){const _=E(!0),d=E(null),n=E([]),p=E(null),i=E(null),c=E(null);function V(T=5e3){return new Promise((m,l)=>{const k=Date.now(),a=setInterval(()=>{window.google?.maps?.places?.PlacesService?(clearInterval(a),m()):Date.now()-k>T&&(clearInterval(a),l(new Error("Google Maps Places API не завантажено.")))},100)})}async function P(T="uk"){_.value=!0,d.value=null,n.value=[];try{if(await V(),!c.value)throw new Error("PlacesService element is missing.");new google.maps.places.PlacesService(c.value).getDetails({placeId:b,fields:["reviews","rating","user_ratings_total"],language:T},(l,k)=>{if(k===google.maps.places.PlacesServiceStatus.OK&&l){const a=l;n.value=(a.reviews||[]).filter(v=>typeof v.rating=="number").slice(0,8).map(v=>({author_name:v.author_name||"Anonymous",rating:v.rating,text:v.text||"",profile_photo_url:v.profile_photo_url||""})),p.value=a.rating||null,i.value=a.user_ratings_total||null}else{const a=`Could not get reviews: ${k}`;console.error(a),d.value=a}})}catch(m){const l=m instanceof Error?m.message:"An unknown error occurred.";console.error("Error loading reviews:",l),d.value=`Error loading reviews: ${l}`}finally{_.value=!1}}return{loading:_,error:d,reviews:n,rating:p,userRatingsTotal:i,placesServiceEl:c,_loadReviews:P}}const ie={class:"mt-2"},ce=A({__name:"EmptyStateError",props:{options:{default:()=>({})}},setup(b){const _=Z("dl-empty-state.svg"),d=b,n={title:"Помилка завантаження відгуків",error:"Сталася невідома помилка.",message:"Нам не вдалося завантажити дані Google Places. Перевірте ваше підключення до мережі або спробуйте пізніше.",buttonText:"Спробувати ще раз"},p=S(()=>({...n,...d.options}));return(i,c)=>(o(),x(M,{class:"text-center pa-6 rounded-lg elevation-4 error-state-card",color:"#FFF3F3"},{default:r(()=>[s($,{width:"64",src:e(_),class:"mb-4 mx-auto",alt:"icon"},null,8,["src"]),s(L,{class:"text-h5 font-weight-medium grey--text text--darken-3"},{default:r(()=>[w(t(p.value.title),1)]),_:1}),s(B,{class:"red--text text--darken-1"},{default:r(()=>[w(t(p.value.error)+" ",1),u("div",ie,t(p.value.message),1)]),_:1}),s(N,{class:"justify-center"},{default:r(()=>[s(O,{color:"red darken-1",text:"",onClick:c[0]||(c[0]=V=>i.$emit("loadReviews")),class:"font-weight-bold","aria-label":"retry-button"},{default:r(()=>[s(j,{left:"",class:"mr-2"},{default:r(()=>[...c[1]||(c[1]=[w("mdi-refresh",-1)])]),_:1}),w(" "+t(p.value.buttonText),1)]),_:1})]),_:1})]),_:1}))}}),ue=Y(ce,[["__scopeId","data-v-0e8d616c"]]),de={class:"mt-2"},pe=A({__name:"EmptyStateEmpty",props:{options:{default:()=>({})}},setup(b){const _=b,d={title:"Відгуків поки що немає",subtitle:"Поки що немає відгуків для цього місця.",message:"Будьте першим, хто поділиться своєю думкою! Ваша оцінка та відгук дуже допоможуть іншим користувачам.",buttonText:"Залишити відгук",placeId:""},n=S(()=>({...d,..._.options}));return(p,i)=>(o(),x(M,{class:"text-center pa-6 rounded-lg elevation-2 empty-state-card",flat:"",color:"#F9F9F9"},{default:r(()=>[s(j,{size:"64",color:"amber darken-1",class:"mb-4"},{default:r(()=>[...i[0]||(i[0]=[w("mdi-star-half-full",-1)])]),_:1}),s(L,{class:"text-h5 font-weight-medium grey--text text--darken-3"},{default:r(()=>[w(t(n.value.title),1)]),_:1}),s(B,{class:"grey--text text--darken-1"},{default:r(()=>[w(t(n.value.subtitle)+" ",1),u("div",de,t(n.value.message),1)]),_:1}),n.value.placeId?(o(),x(N,{key:0,class:"justify-center"},{default:r(()=>[s(O,{color:"amber darken-1",rel:"noopener",target:"_blank",href:"https://search.google.com/local/writereview?placeid="+n.value.placeId,dark:"",depressed:"","aria-label":"leave-review-button"},{default:r(()=>[w(t(n.value.buttonText),1)]),_:1},8,["href"])]),_:1})):y("",!0)]),_:1}))}}),ve={class:"section reviews"},_e={key:0,class:"section-header"},me={class:"section-header__icon"},ge={class:"section-header__wrapper"},fe={class:"section-header__title"},he={class:"section-header__sub-title"},we={key:0,class:"reviews__skeleton"},ye={key:3,class:"reviews__header"},be={class:"reviews__rating"},ke={class:"mt-1 text-body-2 text-grey-darken-1"},xe={class:"d-flex align-center mb-2"},Ee={class:"font-weight-medium ml-2"},Se={class:"review-card__text"},Ve={key:5,class:"text-grey-darken-1 text-body-2 mt-4"},Te=A({__name:"GoogleReviews",props:{options:{default:()=>({})}},setup(b){J(g=>({v7d36c184:e(P).start,v5e6e667d:e(P).end}));const{smAndDown:_,md:d,lgAndUp:n}=Q(),p=b,i=ee(),c=void 0,{handleProgress:V,gradientOpacity:P}=re(),T=S(()=>_.value?1:d.value?2:n.value?3:1),m=S(()=>{const g=i.currentLang;return{error:le[g],empty:oe[g]}}),l=S(()=>({...p.options,...i.googleReviews||{},placeId:c})),k=S(()=>i.currentLang==="ua"?"uk":i.currentLang),{loading:a,error:v,reviews:I,rating:C,userRatingsTotal:q,placesServiceEl:K,_loadReviews:U}=ne(c),F=te(g=>U(g),3e3,!0);return W(k,(g,R)=>{g!==R&&F(g)}),X(()=>{F(k.value)}),(g,R)=>(o(),h("div",ve,[u("div",{ref_key:"placesServiceEl",ref:K,style:{display:"none"}},null,512),l.value?.title?(o(),h("div",_e,[u("div",me,[s($,{src:e(i).userIconsMap["google-icon.svg"],alt:"icon"},null,8,["src"])]),u("div",ge,[u("h2",fe,t(l.value.title||"Наші послуги"),1),u("h3",he,t(l.value.subtitle),1)])])):y("",!0),s(M,{class:"reviews__wrapper",elevation:"4"},{default:r(()=>[s(B,null,{default:r(()=>[e(a)&&!e(v)?(o(),h("div",we,[(o(!0),h(z,null,D(T.value,f=>(o(),x(se,{key:`review-skeleton-${f}`,type:"card",width:"100%",height:400,loading:e(a)},null,8,["loading"]))),128))])):y("",!0),!e(a)&&e(v)?(o(),x(ue,{key:1,options:{...m.value.error},onLoadReviews:e(F)},null,8,["options","onLoadReviews"])):y("",!0),!e(a)&&!e(v)&&!e(I).length?(o(),x(pe,{key:2,options:{...m.value.empty,placeId:l.value.placeId}},null,8,["options"])):y("",!0),!e(a)&&e(C)?(o(),h("div",ye,[u("div",be,[s(G,{"model-value":e(C),color:"amber","background-color":"grey-lighten-2",readonly:"","half-increments":""},null,8,["model-value"]),u("div",ke,t(e(C).toFixed(1))+" "+t(l.value.part_1)+" ("+t(e(q))+" "+t(l.value.part_2)+") ",1)]),s(O,{color:"amber darken-1",rel:"noopener",target:"_blank",href:"https://search.google.com/local/writereview?placeid="+e(c),dark:"",depressed:"","aria-label":"leave-review-button"},{default:r(()=>[w(t(m.value.empty.buttonText),1)]),_:1},8,["href"])])):y("",!0),!e(a)&&e(I).length?(o(),h("swiper-container",{key:4,class:"swiper-horizontal slider",ref:"swiperEl",onSwiperprogress:R[0]||(R[0]=(...f)=>e(V)&&e(V)(...f)),direction:"horizontal","slides-per-view":"auto",breakpoints:{1:{slidesPerView:1,freeMode:{enabled:!1}},768:{slidesPerView:2,freeMode:{enabled:!0,momentum:!1,momentumBounce:!1}},992:{slidesPerView:3,freeMode:{enabled:!0,momentum:!1,momentumBounce:!1}}},"free-mode":"","free-mode-momentum":!1,"free-mode-momentum-bounce":!1,scrollbar:{draggable:!0,dragSize:150},navigation:!0,"space-between":24,observer:"","observe-slide-children":"","touch-start-force-prevent-default":""},[(o(!0),h(z,null,D(e(I),(f,H)=>(o(),h("swiper-slide",{key:`slide-key-${H}`,class:"slider__slide"},[s(M,{variant:"elevated",class:"pa-3 flex-grow-1 review-card"},{default:r(()=>[u("div",xe,[f.profile_photo_url?(o(),x(ae,{key:0,size:"32"},{default:r(()=>[s($,{src:f.profile_photo_url,alt:"avatar"},null,8,["src"])]),_:2},1024)):y("",!0),u("div",Ee,t(f.author_name),1)]),s(G,{"model-value":f.rating,color:"amber","background-color":"grey-lighten-2",readonly:"",dense:"","half-increments":"",class:"mb-2"},null,8,["model-value"]),u("div",Se,t(f.text),1)]),_:2},1024)]))),128))],544)):!e(a)&&!e(I).length?(o(),h("div",Ve,t(l.value?.empty_state||"Відгуки відсутні"),1)):y("",!0)]),_:1})]),_:1})]))}}),Ce=Y(Te,[["__scopeId","data-v-c318af92"]]);export{Ce as default};
