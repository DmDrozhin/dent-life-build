import{r as R,d as G,c as S,c6 as E,c7 as n,c8 as r,K as t,u as e,be as y,aA as s,H as v,cb as x,cc as q,aI as Q,w as W,a7 as X,c9 as k,ab as D,ca as z}from"./vuetify-B1nIqfL7.js";import{ar as Z,V as B,aK as K,aG as O,a_ as N,as as L,ai as Y,aF as P,u as ee,a$ as te,aI as ae,b0 as F,ak as se,_ as re}from"./app-BR_RcUgu.js";import{u as oe}from"./swiper-scroll-Br6VOSNx.js";import{E as le,a as ne}from"./EmptyState-D9jLvqBp.js";function ie(i=5e3){return new Promise((c,u)=>{const a=Date.now(),o=setInterval(()=>{window.google?.maps?.places?.PlacesService?(clearInterval(o),c()):Date.now()-a>i&&(clearInterval(o),u(new Error("Google Maps Places API не завантажено.")))},100)})}const A={};function ce(i){const c=R(!0),u=R(null),a=R([]),o=R(null),l=R(null),d=R(null);async function T(V="uk"){if(A[i]){const p=A[i];a.value=p.reviews,o.value=p.rating,l.value=p.userRatingsTotal,c.value=!1;return}c.value=!0,u.value=null,a.value=[];try{if(await ie(),!d.value)throw new Error("PlacesService element is missing.");new google.maps.places.PlacesService(d.value).getDetails({placeId:i,fields:["reviews","rating","user_ratings_total"],language:V},(m,g)=>{if(g===google.maps.places.PlacesServiceStatus.OK&&m){const f=m,w=(f.reviews||[]).filter(_=>typeof _.rating=="number").slice(0,8).map(_=>({author_name:_.author_name||"Anonymous",rating:_.rating,text:_.text||"",profile_photo_url:_.profile_photo_url||""}));a.value=w,o.value=f.rating||null,l.value=f.user_ratings_total||null,A[i]={reviews:w,rating:o.value,userRatingsTotal:l.value}}else{const f=`Could not get reviews: ${g}`;console.error(f),u.value=f}})}catch(p){const m=p instanceof Error?p.message:"Unknown error";console.error("Error loading reviews:",m),u.value=`Error loading reviews: ${m}`}finally{c.value=!1}}return{loading:c,error:u,reviews:a,rating:o,userRatingsTotal:l,placesServiceEl:d,_loadReviews:T}}const ue={class:"mt-2"},de=G({__name:"EmptyStateError",props:{options:{default:()=>({})}},setup(i){const c=Z("dl-empty-state.svg"),u=i,a={title:"Помилка завантаження відгуків",error:"Сталася невідома помилка.",message:"Нам не вдалося завантажити дані Google Places. Перевірте ваше підключення до мережі або спробуйте пізніше.",buttonText:"Спробувати ще раз"},o=S(()=>({...a,...u.options}));return(l,d)=>(n(),E(P,{class:"text-center pa-6 rounded-lg elevation-0 error-state-card",color:"background"},{default:r(()=>[t(B,{width:"64",src:e(c),class:"mb-4 mx-auto",alt:"icon"},null,8,["src"]),t(K,{class:"text-h5 font-weight-medium grey--text text--darken-3"},{default:r(()=>[y(s(o.value.title),1)]),_:1}),t(O,{class:"red--text text--darken-1"},{default:r(()=>[y(s(o.value.error)+" ",1),v("div",ue,s(o.value.message),1)]),_:1}),t(N,{class:"justify-center"},{default:r(()=>[t(L,{color:"red darken-1",text:"",onClick:d[0]||(d[0]=T=>l.$emit("loadReviews")),class:"font-weight-bold","aria-label":"retry-button"},{default:r(()=>[t(Y,{left:"",class:"mr-2"},{default:r(()=>[...d[1]||(d[1]=[y("mdi-refresh",-1)])]),_:1}),y(" "+s(o.value.buttonText),1)]),_:1})]),_:1})]),_:1}))}}),ve={class:"mt-2"},_e=G({__name:"EmptyStateEmpty",props:{options:{default:()=>({})}},setup(i){const c=i,u={title:"Відгуків поки що немає",subtitle:"Поки що немає відгуків для цього місця.",message:"Будьте першим, хто поділиться своєю думкою! Ваша оцінка та відгук дуже допоможуть іншим користувачам.",buttonText:"Залишити відгук",placeId:""},a=S(()=>({...u,...c.options}));return(o,l)=>(n(),E(P,{class:"text-center pa-6 rounded-lg elevation-0 empty-state-card",flat:"",color:"background"},{default:r(()=>[t(Y,{size:"64",color:"amber darken-1",class:"mb-4"},{default:r(()=>[...l[0]||(l[0]=[y("mdi-star-half-full",-1)])]),_:1}),t(K,{class:"text-h5 font-weight-medium grey--text text--darken-3"},{default:r(()=>[y(s(a.value.title),1)]),_:1}),t(O,{class:"grey--text text--darken-1"},{default:r(()=>[y(s(a.value.subtitle)+" ",1),v("div",ve,s(a.value.message),1)]),_:1}),a.value.placeId?(n(),E(N,{key:0,class:"justify-center"},{default:r(()=>[t(L,{color:"amber darken-3",rel:"noopener",target:"_blank",href:"https://search.google.com/local/writereview?placeid="+a.value.placeId,dark:"",depressed:"","aria-label":"leave-review-button"},{default:r(()=>[y(s(a.value.buttonText),1)]),_:1},8,["href"])]),_:1})):x("",!0)]),_:1}))}}),pe={class:"section reviews"},me={key:0,class:"section-header"},ge={class:"section-header__icon"},fe={class:"section-header__wrapper"},we={class:"section-header__title"},he={class:"section-header__sub-title"},be={key:0,class:"reviews__skeleton"},ye={key:3,class:"reviews__header"},ke={class:"reviews__rating"},xe={class:"mt-1 text-body-2 text-grey-darken-1"},Ee={class:"d-flex align-center mb-2"},Re={class:"font-weight-medium ml-2"},Se={class:"review-card__text"},Te=G({__name:"SectionGoogleReviews",props:{options:{default:()=>({})}},setup(i){q(h=>({v19ed8e18:e(V).start,v31d74811:e(V).end}));const{smAndDown:c,md:u,lgAndUp:a}=Q(),o=i,l=ee(),d="ChIJL4TJ_yrK1EAReMIGRmIpBMM",{handleProgress:T,gradientOpacity:V}=oe(),p=S(()=>c.value?1:u.value?2:a.value?3:1),m=S(()=>{const h=l.currentLang;return{error:ne[h],empty:le[h]}}),g=S(()=>({...o.options,...l.googleReviews||{},placeId:d})),f=S(()=>l.currentLang==="ua"?"uk":l.currentLang),{loading:w,error:_,reviews:M,rating:C,userRatingsTotal:j,placesServiceEl:J,_loadReviews:U}=ce(d),$=te(h=>U(h),3e3,!0);return W(f,(h,I)=>{h!==I&&$(h)}),X(()=>{$(f.value)}),(h,I)=>(n(),k("div",pe,[v("div",{ref_key:"placesServiceEl",ref:J,style:{display:"none"}},null,512),g.value?.title?(n(),k("div",me,[v("div",ge,[t(B,{src:e(l).userIconsMap["google-icon.svg"],alt:"icon"},null,8,["src"])]),v("div",fe,[v("h2",we,s(g.value.title||"Наші послуги"),1),v("h3",he,s(g.value.subtitle),1)])])):x("",!0),t(P,{class:"reviews__wrapper",elevation:"4"},{default:r(()=>[t(O,null,{default:r(()=>[e(w)&&!e(_)?(n(),k("div",be,[(n(!0),k(D,null,z(p.value,b=>(n(),E(ae,{key:`review-skeleton-${b}`,type:"card",width:"100%",height:400,loading:e(w)},null,8,["loading"]))),128))])):x("",!0),!e(w)&&e(_)?(n(),E(de,{key:1,options:{...m.value.error},onLoadReviews:e($)},null,8,["options","onLoadReviews"])):x("",!0),!e(w)&&!e(_)&&!e(M).length?(n(),E(_e,{key:2,options:{...m.value.empty,placeId:g.value.placeId}},null,8,["options"])):x("",!0),!e(w)&&e(C)?(n(),k("div",ye,[v("div",ke,[t(F,{"model-value":e(C),color:"amber","background-color":"grey-lighten-2",readonly:"","half-increments":""},null,8,["model-value"]),v("div",xe,s(e(C).toFixed(1))+" "+s(g.value.part_1)+" ("+s(e(j))+" "+s(g.value.part_2)+") ",1)]),t(L,{color:"amber darken-1",rel:"noopener",target:"_blank",href:"https://search.google.com/local/writereview?placeid="+e(d),dark:"",depressed:"","aria-label":"leave-review-button"},{default:r(()=>[y(s(m.value.empty.buttonText),1)]),_:1},8,["href"])])):x("",!0),!e(w)&&e(M).length?(n(),k("swiper-container",{key:4,class:"swiper-horizontal slider",ref:"swiperEl",onSwiperprogress:I[0]||(I[0]=(...b)=>e(T)&&e(T)(...b)),direction:"horizontal","slides-per-view":"auto",breakpoints:{1:{slidesPerView:1,freeMode:{enabled:!1}},768:{slidesPerView:2,freeMode:{enabled:!0,momentum:!1,momentumBounce:!1}},992:{slidesPerView:3,freeMode:{enabled:!0,momentum:!1,momentumBounce:!1}}},"free-mode":"","free-mode-momentum":!1,"free-mode-momentum-bounce":!1,scrollbar:{draggable:!0,dragSize:150},navigation:!0,"space-between":24,observer:"","observe-slide-children":"","touch-start-force-prevent-default":""},[(n(!0),k(D,null,z(e(M),(b,H)=>(n(),k("swiper-slide",{key:`slide-key-${H}`,class:"slider__slide"},[t(P,{variant:"elevated",class:"pa-3 flex-grow-1 review-card"},{default:r(()=>[v("div",Ee,[b.profile_photo_url?(n(),E(se,{key:0,size:"32"},{default:r(()=>[t(B,{src:b.profile_photo_url,alt:"avatar"},null,8,["src"])]),_:2},1024)):x("",!0),v("div",Re,s(b.author_name),1)]),t(F,{"model-value":b.rating,color:"amber","background-color":"grey-lighten-2",readonly:"",dense:"","half-increments":"",class:"mb-2"},null,8,["model-value"]),v("div",Se,s(b.text),1)]),_:2},1024)]))),128))],544)):x("",!0)]),_:1})]),_:1})]))}}),Ce=re(Te,[["__scopeId","data-v-834bc0e0"]]);export{Ce as default};
