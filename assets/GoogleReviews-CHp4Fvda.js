import{r as E,c5 as B,d as S,c8 as x,c7 as o,c9 as s,C as t,aj as e,bb as h,ax as a,z as u,cb as b,cg as H,aF as Q,w as W,a1 as X,c6 as w,a5 as L,ca as z}from"./vuetify-CdQs1uHv.js";import{p as Z,V as $,g as F,c as O,q as N,o as G,d as j,a as P,_ as Y,u as ee,r as te,n as ae,s as D,t as se}from"./index-CaTrxQlD.js";import{u as re}from"./swiper-scroll-Bo_abshO.js";import{E as oe,a as le}from"./EmptyState-D9jLvqBp.js";function ne(y){const _=E(!0),d=E(null),l=E([]),p=E(null),i=E(null),c=E(null);function I(T=5e3){return new Promise((m,n)=>{const k=Date.now(),r=setInterval(()=>{window.google?.maps?.places?.PlacesService?(clearInterval(r),m()):Date.now()-k>T&&(clearInterval(r),n(new Error("Google Maps Places API не завантажено.")))},100)})}async function V(T="uk"){_.value=!0,d.value=null,l.value=[];try{if(await I(),!c.value)throw new Error("PlacesService element is missing.");new google.maps.places.PlacesService(c.value).getDetails({placeId:y,fields:["reviews","rating","user_ratings_total"],language:T},(n,k)=>{if(k===google.maps.places.PlacesServiceStatus.OK&&n){const r=n;l.value=(r.reviews||[]).filter(v=>typeof v.rating=="number").slice(0,8).map(v=>({author_name:v.author_name||"Anonymous",rating:v.rating,text:v.text||"",profile_photo_url:v.profile_photo_url||""})),p.value=r.rating||null,i.value=r.user_ratings_total||null}else{const r=`Could not get reviews: ${k}`;console.error(r),d.value=r}})}catch(m){const n=m instanceof Error?m.message:"An unknown error occurred.";console.error("Error loading reviews:",n),d.value=`Error loading reviews: ${n}`}finally{_.value=!1}}return{loading:_,error:d,reviews:l,rating:p,userRatingsTotal:i,placesServiceEl:c,_loadReviews:V}}const ie={class:"mt-2"},ce=B({__name:"EmptyStateError",props:{options:{default:()=>({})}},setup(y){const _=Z("dl-empty-state.svg"),d=y,l={title:"Помилка завантаження відгуків",error:"Сталася невідома помилка.",message:"Нам не вдалося завантажити дані Google Places. Перевірте ваше підключення до мережі або спробуйте пізніше.",buttonText:"Спробувати ще раз"},p=S(()=>({...l,...d.options}));return(i,c)=>(o(),x(P,{class:"text-center pa-6 rounded-lg elevation-0 error-state-card",color:"background"},{default:s(()=>[t($,{width:"64",src:e(_),class:"mb-4 mx-auto",alt:"icon"},null,8,["src"]),t(F,{class:"text-h5 font-weight-medium grey--text text--darken-3"},{default:s(()=>[h(a(p.value.title),1)]),_:1}),t(O,{class:"red--text text--darken-1"},{default:s(()=>[h(a(p.value.error)+" ",1),u("div",ie,a(p.value.message),1)]),_:1}),t(N,{class:"justify-center"},{default:s(()=>[t(G,{color:"red darken-1",text:"",onClick:c[0]||(c[0]=I=>i.$emit("loadReviews")),class:"font-weight-bold","aria-label":"retry-button"},{default:s(()=>[t(j,{left:"",class:"mr-2"},{default:s(()=>[...c[1]||(c[1]=[h("mdi-refresh",-1)])]),_:1}),h(" "+a(p.value.buttonText),1)]),_:1})]),_:1})]),_:1}))}}),ue=Y(ce,[["__scopeId","data-v-c4c5107d"]]),de={class:"mt-2"},pe=B({__name:"EmptyStateEmpty",props:{options:{default:()=>({})}},setup(y){const _=y,d={title:"Відгуків поки що немає",subtitle:"Поки що немає відгуків для цього місця.",message:"Будьте першим, хто поділиться своєю думкою! Ваша оцінка та відгук дуже допоможуть іншим користувачам.",buttonText:"Залишити відгук",placeId:""},l=S(()=>({...d,..._.options}));return(p,i)=>(o(),x(P,{class:"text-center pa-6 rounded-lg elevation-0 empty-state-card",flat:"",color:"background"},{default:s(()=>[t(j,{size:"64",color:"amber darken-1",class:"mb-4"},{default:s(()=>[...i[0]||(i[0]=[h("mdi-star-half-full",-1)])]),_:1}),t(F,{class:"text-h5 font-weight-medium grey--text text--darken-3"},{default:s(()=>[h(a(l.value.title),1)]),_:1}),t(O,{class:"grey--text text--darken-1"},{default:s(()=>[h(a(l.value.subtitle)+" ",1),u("div",de,a(l.value.message),1)]),_:1}),l.value.placeId?(o(),x(N,{key:0,class:"justify-center"},{default:s(()=>[t(G,{color:"amber darken-3",rel:"noopener",target:"_blank",href:"https://search.google.com/local/writereview?placeid="+l.value.placeId,dark:"",depressed:"","aria-label":"leave-review-button"},{default:s(()=>[h(a(l.value.buttonText),1)]),_:1},8,["href"])]),_:1})):b("",!0)]),_:1}))}}),ve={class:"section reviews"},_e={key:0,class:"section-header"},me={class:"section-header__icon"},fe={class:"section-header__wrapper"},ge={class:"section-header__title"},he={class:"section-header__sub-title"},we={key:0,class:"reviews__skeleton"},be={key:3,class:"reviews__header"},ye={class:"reviews__rating"},ke={class:"mt-1 text-body-2 text-grey-darken-1"},xe={class:"d-flex align-center mb-2"},Ee={class:"font-weight-medium ml-2"},Se={class:"review-card__text"},Ie=B({__name:"GoogleReviews",props:{options:{default:()=>({})}},setup(y){H(f=>({v3f3fb7ce:e(V).start,v676d2b5c:e(V).end}));const{smAndDown:_,md:d,lgAndUp:l}=Q(),p=y,i=ee(),c="ChIJL4TJ_yrK1EAReMIGRmIpBMM",{handleProgress:I,gradientOpacity:V}=re(),T=S(()=>_.value?1:d.value?2:l.value?3:1),m=S(()=>{const f=i.currentLang;return{error:le[f],empty:oe[f]}}),n=S(()=>({...p.options,...i.googleReviews||{},placeId:c})),k=S(()=>i.currentLang==="ua"?"uk":i.currentLang),{loading:r,error:v,reviews:M,rating:C,userRatingsTotal:J,placesServiceEl:K,_loadReviews:q}=ne(c),A=te(f=>q(f),3e3,!0);return W(k,(f,R)=>{f!==R&&A(f)}),X(()=>{A(k.value)}),(f,R)=>(o(),w("div",ve,[u("div",{ref_key:"placesServiceEl",ref:K,style:{display:"none"}},null,512),n.value?.title?(o(),w("div",_e,[u("div",me,[t($,{src:e(i).userIconsMap["google-icon.svg"],alt:"icon"},null,8,["src"])]),u("div",fe,[u("h2",ge,a(n.value.title||"Наші послуги"),1),u("h3",he,a(n.value.subtitle),1)])])):b("",!0),t(P,{class:"reviews__wrapper",elevation:"4"},{default:s(()=>[t(O,null,{default:s(()=>[e(r)&&!e(v)?(o(),w("div",we,[(o(!0),w(L,null,z(T.value,g=>(o(),x(ae,{key:`review-skeleton-${g}`,type:"card",width:"100%",height:400,loading:e(r)},null,8,["loading"]))),128))])):b("",!0),!e(r)&&e(v)?(o(),x(ue,{key:1,options:{...m.value.error},onLoadReviews:e(A)},null,8,["options","onLoadReviews"])):b("",!0),!e(r)&&!e(v)&&!e(M).length?(o(),x(pe,{key:2,options:{...m.value.empty,placeId:n.value.placeId}},null,8,["options"])):b("",!0),!e(r)&&e(C)?(o(),w("div",be,[u("div",ye,[t(D,{"model-value":e(C),color:"amber","background-color":"grey-lighten-2",readonly:"","half-increments":""},null,8,["model-value"]),u("div",ke,a(e(C).toFixed(1))+" "+a(n.value.part_1)+" ("+a(e(J))+" "+a(n.value.part_2)+") ",1)]),t(G,{color:"amber darken-1",rel:"noopener",target:"_blank",href:"https://search.google.com/local/writereview?placeid="+e(c),dark:"",depressed:"","aria-label":"leave-review-button"},{default:s(()=>[h(a(m.value.empty.buttonText),1)]),_:1},8,["href"])])):b("",!0),!e(r)&&e(M).length?(o(),w("swiper-container",{key:4,class:"swiper-horizontal slider",ref:"swiperEl",onSwiperprogress:R[0]||(R[0]=(...g)=>e(I)&&e(I)(...g)),direction:"horizontal","slides-per-view":"auto",breakpoints:{1:{slidesPerView:1,freeMode:{enabled:!1}},768:{slidesPerView:2,freeMode:{enabled:!0,momentum:!1,momentumBounce:!1}},992:{slidesPerView:3,freeMode:{enabled:!0,momentum:!1,momentumBounce:!1}}},"free-mode":"","free-mode-momentum":!1,"free-mode-momentum-bounce":!1,scrollbar:{draggable:!0,dragSize:150},navigation:!0,"space-between":24,observer:"","observe-slide-children":"","touch-start-force-prevent-default":""},[(o(!0),w(L,null,z(e(M),(g,U)=>(o(),w("swiper-slide",{key:`slide-key-${U}`,class:"slider__slide"},[t(P,{variant:"elevated",class:"pa-3 flex-grow-1 review-card"},{default:s(()=>[u("div",xe,[g.profile_photo_url?(o(),x(se,{key:0,size:"32"},{default:s(()=>[t($,{src:g.profile_photo_url,alt:"avatar"},null,8,["src"])]),_:2},1024)):b("",!0),u("div",Ee,a(g.author_name),1)]),t(D,{"model-value":g.rating,color:"amber","background-color":"grey-lighten-2",readonly:"",dense:"","half-increments":"",class:"mb-2"},null,8,["model-value"]),u("div",Se,a(g.text),1)]),_:2},1024)]))),128))],544)):b("",!0)]),_:1})]),_:1})]))}}),Me=Y(Ie,[["__scopeId","data-v-4f86fbc7"]]);export{Me as default};
